<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="STAT425, Fall 2023">
<meta name="dcterms.date" content="2023-09-28">

<title>STAT425 - Counting rules</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-H3YKZX4J88"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-H3YKZX4J88', { 'anonymize_ip': true});
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">STAT425</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html" rel="" target="">
 <span class="menu-text">Course syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../content.html" rel="" target="">
 <span class="menu-text">Materials</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#finite-sample-spaces" id="toc-finite-sample-spaces" class="nav-link active" data-scroll-target="#finite-sample-spaces">Finite sample spaces</a></li>
  <li><a href="#counting-combinations" id="toc-counting-combinations" class="nav-link" data-scroll-target="#counting-combinations">Counting combinations</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Counting rules</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Course notes</div>
    <div class="quarto-title-meta-contents">
             <p>STAT425, Fall 2023 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Updated</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 28, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="finite-sample-spaces" class="level3">
<h3 class="anchored" data-anchor-id="finite-sample-spaces">Finite sample spaces</h3>
<p>Suppose <span class="math inline">\(S = \{s_1, \dots, s_n\}\)</span> and <span class="math inline">\(\mathcal{S} = 2^S\)</span>. Let <span class="math inline">\(\{p_i\}\)</span> be <span class="math inline">\(n\)</span> numbers such that <span class="math inline">\(0 \leq p_i \leq 1\)</span> and <span class="math inline">\(\sum_{i = 1}^n p_i = 1\)</span>. Then the set function</p>
<p><span class="math display">\[
P(E) = \sum_{i: x_i \in E} p_i \quad,\; E\in \mathcal{S}
\]</span></p>
<p>is a probability measure on <span class="math inline">\((S, \mathcal{S})\)</span>, <em>i.e.</em>, <span class="math inline">\((S, \mathcal{S}, P)\)</span> is a probability space.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
</div>
<div class="callout-body-container callout-body">
<p>Since by construction <span class="math inline">\(\mathcal{S}\)</span> is a <span class="math inline">\(\sigma\)</span>-algebra, it remains only to check that <span class="math inline">\(P\)</span> satisfies the probability axioms.</p>
<ul>
<li>Axiom 1: <span class="math inline">\(P(E) = \sum_{i: x_i \in E} p_i \geq 0\)</span> since by hypothesis <span class="math inline">\(p_i \geq 0\)</span>.</li>
<li>Axiom 2: <span class="math inline">\(P(S) = \sum_{i: x_i \in E} p_i = \sum_{i = 1}^n p_i = 1\)</span>.</li>
<li>Axiom 3: let <span class="math inline">\(\{E_j\}\)</span> be disjoint and define <span class="math inline">\(I_j = \{i: x_i \in E_j\}\)</span>. Note that <span class="math inline">\(\left\{i: x_i \in \bigcup_j E_j\right\} = \bigcup_j I_j\)</span> and <span class="math inline">\(I_j \cap I_k = \emptyset\)</span> for <span class="math inline">\(j \neq k\)</span>. Then: <span class="math display">\[
P\left(\bigcup_j E_j\right) = \sum_{\bigcup_j I_j} p_i = \sum_j \sum_{I_j} p_i = \sum_j P(E_j)
\]</span></li>
</ul>
</div>
</div>
<p>So, probability measures on finite sample spaces are simply assignments of numbers in <span class="math inline">\([0, 1]\)</span> to each outcome that sum to one.</p>
<p>Now, if one has <span style="color:blue">equally likely outcomes</span> in a finite sample space, <em>i.e.</em>, <span class="math inline">\(p_i = p_j\)</span>, then: <span class="math display">\[
P(E) = \sum_{i: x_i \in E} p_i = \sum_{i: x_i \in E} \frac{1}{|S|} = \frac{|E|}{|S|}
\]</span></p>
<p>Thus, for finite probability spaces with equally likely outcomes, computing event probabilities is a matter of <span style="color:blue">counting</span>. While conceptually straightforward, it is often nontrivial to count the elements in a set. For example, how would you count the number of ways to draw a 3-of-a-kind in a 5-card poker hand? In other words, how many distinct combinations of 5 cards contain exactly three of matching rank and no other matches? For that matter, how many 5-card poker hands are possible? Once you know the answer, finding the probability of a 3-of-a-kind (or obtaining one by drawing 5 cards at random, anyway) is easy; counting the outcomes is the tricky part.</p>
</section>
<section id="counting-combinations" class="level3">
<h3 class="anchored" data-anchor-id="counting-combinations">Counting combinations</h3>
<p>Many counting problems reduce to tabulating the possible combinations formed from drawing elements from small finite sets according to certain rules. Depending on whether elements are drawn with or without replacement (can you draw the same element twice?), how many elements are drawn, and whether a combination drawn in a different order is regarded as a distinct outcome, there are different formulae for counting combinations. These can be derived based on two simple <span style="color:blue">multiplication rules</span>.</p>
<p><em>Note</em>: in what follows, assume that the elements of a set are distinct, <em>i.e.</em>, that if we write <span class="math inline">\(A = \{a_1, \dots, a_n\}\)</span>, then <span class="math inline">\(a_i \neq a_j\)</span> for <span class="math inline">\(i \neq j\)</span>. It would be highly unconventional to list the elements of a set in a way that includes duplicates, since, <em>e.g.</em>, <span class="math inline">\(\{0, 0, 1\} = \{0, 1\}\)</span> according to our definition of set identity.</p>
<p><span style="color:blue">Multiplication Rule 1</span>. Let <span class="math inline">\(A = \{a_1, \dots, a_n\}\)</span> and <span class="math inline">\(B = \{b_1, \dots, b_m\}\)</span>. The number of possible pairs <span class="math inline">\((a, b)\)</span> that can be formed from the two sets is <span class="math inline">\(n \times m\)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
</div>
<div class="callout-body-container callout-body">
<p>More formally, let <span class="math inline">\(|A| = n\)</span> and <span class="math inline">\(|B| = m\)</span>; the statement amounts to <span class="math inline">\(|A \times B| = |A| \times |B| = nm\)</span>. The elements of <span class="math inline">\(A\times B\)</span> can be arranged in an <span class="math inline">\(n \times m\)</span> array</p>
<p><span class="math display">\[
\begin{array}{ccccc}
(a_1, b_1) &amp;(a_1, b_2) &amp;\cdots &amp;(a_1, b_m) \\
(a_2, b_1) &amp;(a_2, b_2) &amp;\cdots &amp;(a_2, b_m) \\
\vdots &amp;\vdots &amp;\ddots &amp;\vdots \\
(a_n, b_1) &amp;(a_n, b_2) &amp;\cdots &amp;(a_n, b_m) \\
\end{array}
\]</span> showing that there are <span class="math inline">\(n \times m\)</span> distinct pairs.</p>
</div>
</div>
<p><span style="color:blue">Multiplication Rule 2</span>. Let <span class="math inline">\(A_1, \dots, A_m\)</span> be finite sets with <span class="math inline">\(|A_i| = n_i\)</span>. Then:</p>
<p><span class="math display">\[
|A_1 \times \cdots \times A_m| = |A_1| \times \cdots \times |A_m| = \prod_{i = 1}^m n_i
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
</div>
<div class="callout-body-container callout-body">
<p>Apply multiplication rule 1 recursively. Define <span class="math inline">\(B_i = A_1 \times \cdots \times A_i\)</span>. Note that <span class="math inline">\(B_i = B_{i - 1} \times A_i\)</span>, so by multiplication rule 1, <span class="math inline">\(|B_i| = |B_{i - 1}|\times n_i\)</span>. Note also that <span class="math inline">\(|B_1| = |A_1| = n_1\)</span>. Then:</p>
<p><span class="math display">\[
\begin{align*}
|A_1 \times \cdots \times A_m|
&amp;= |B_{m - 1} \times A_m| \\
&amp;= |B_{m - 1}| \times n_m \\
&amp;= |B_{m - 2}| \times n_{m - 1} \times n_m \\
&amp;\;\;\vdots \\
&amp;= |B_1| \times n_2 \times \cdots \times n_m \\
&amp;= n_1 \times n_2 \times \cdots \times n_m \\
&amp;= \prod_{i = 1}^m n_i
\end{align*}
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check your understanding
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>If you’re buying nuts, apples, and cheese at the store and there are three kinds of nuts, four varieties of apples, and five cheeses, how many distinct purchases are possible if you only buy one kind of each item? Which multiplication rule did you use to determine an answer?</li>
<li>In forming combinations, there are two common methods of drawing elements from a set – with or without replacement – and two common methods of recording draws – with or without the order in which elements were drawn. How many ways are there to form combinations? Which multiplication rule did you use to determine an answer?</li>
</ol>
</div>
</div>
<p>Now consider forming combinations of <span class="math inline">\(k\)</span> elements drawn from a finite set <span class="math inline">\(A = \{a_1, \dots, a_n\}\)</span> with <span class="math inline">\(|A| = n\)</span>. The number of combinations depends on how they are formed: by drawing with or without replacement, and by accounting for or ignoring the order in which elements were drawn. Formally, these methods correspond to the following sets:</p>
<ul>
<li>(ordered, with replacement) <span class="math inline">\(\{(a_{j_1}, \dots, a_{j_k}): j_i \in \{1, \dots, n\}\}\)</span></li>
<li>(ordered, without replacement) <span class="math inline">\(\{(a_{j_1}, \dots, a_{j_k}): j_i \in \{1, \dots, n\}; j_i \neq j_l \text{ for } i \neq l\}\)</span></li>
<li>(unordered, with replacement) <span class="math inline">\(\{[a_{j_1}, \dots, a_{j_k}]: j_i \in \{1, \dots, n\}\}\)</span><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></li>
<li>(unordered, without replacement) <span class="math inline">\(\{\{a_{j_1}, \dots, a_{j_k}\}: j_i \in \{1, \dots, n\}; j_i \neq j_l \text{ for } i \neq l\}\)</span></li>
</ul>
<p>In what follows, counting rules for each situation will be derived. The proofs rely in many instances on two facts: for disjoint sets <span class="math inline">\(A, B\)</span>, <span class="math inline">\(|A\cup B| = |A| + |B|\)</span>; and if <span class="math inline">\(A \subseteq B\)</span>, then <span class="math inline">\(|B\setminus A| = |B| - |A|\)</span>.</p>
<p><strong>Sampling with replacement 1 (SWR1).</strong> Let <span class="math inline">\(A\)</span> be a set with <span class="math inline">\(|A| = n\)</span>. The number of <span style="color:blue">ordered</span> combinations of <span class="math inline">\(k\)</span> elements drawn <span style="color:blue">with replacement</span> from <span class="math inline">\(A\)</span> is <span class="math inline">\(n^k\)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
</div>
<div class="callout-body-container callout-body">
<p>Enumerate the elements of <span class="math inline">\(A\)</span> as <span class="math inline">\(A = \{a_1, \dots, a_n\}\)</span>. The ordered combinations of <span class="math inline">\(k\)</span> elements of <span class="math inline">\(A\)</span> drawn with replacement are the distinct <span class="math inline">\(k\)</span>-tuples <span class="math inline">\((a_{j_1}, \dots, a_{j_k})\)</span> where <span class="math inline">\(j_i \in \{1, \dots, n\}\)</span> is some index. Note that possibly <span class="math inline">\(j_i = j_l\)</span> according to this schema. Now, <span class="math inline">\(\{(a_{j_1}, \dots, a_{j_k}): j_i \in \{1, \dots, n\}\} = A^k\)</span>, so using multiplication rule 2:</p>
<p><span class="math display">\[
|A^k| = |A \times \cdots \times A| = |A| \times \cdots \times |A| = |A|^k = n^k
\]</span></p>
</div>
</div>
<p><strong>Sampling without replacement 1 (SWOR1)</strong>. Let <span class="math inline">\(A\)</span> be a set with <span class="math inline">\(|A| = n\)</span>. The number of <span style="color:blue">ordered</span> combinations of <span class="math inline">\(k\)</span> distinct elements drawn <span style="color:blue">without replacement</span> from <span class="math inline">\(A\)</span> is:</p>
<p><span class="math display">\[
\frac{n!}{(n - k)!} = n \times (n - 1) \times \cdots \times (n - k + 1)
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(B_k = \{(a_{j_1}, \dots, a_{j_k}): j_i \in \{1, \dots, n\}; j_i \neq j_l \text{ for } i \neq l\}\)</span>. The goal is to show that <span class="math inline">\(|B_k| = \frac{n!}{(n - k)!}\)</span> for arbitrary <span class="math inline">\(k\)</span>. Enumerate the elements of <span class="math inline">\(B_k\)</span> as <span class="math inline">\(B_k = \{b_{k1}, b_{k2}, \dots, b_{kn_k}\}\)</span>. For each element, <span class="math inline">\(b_{ki} = (b_{ki1}, \dots, b_{kik}) = (a_{j_{1_i}}, \dots, a_{j_{k_i}})\)</span> for some collection of distinct indices <span class="math inline">\(j_{1_i}, \dots, j_{k_i}\)</span>. Note also that <span class="math inline">\(B_1 = A\)</span>. Now define:</p>
<p><span class="math display">\[
\begin{align*}
\tilde{b}_{ki} &amp;= \{b_{ki1}, \dots, b_{kik}\} \\
B_{ki} &amp;= \{b \in B_k: b_k \in A \setminus \tilde{b}_{k - 1, i}, (b_1, \dots, b_k - 1) = b_{k - 1, i}\} \\
\end{align*}
\]</span></p>
<p>In other words, <span class="math inline">\(\tilde{b}_{ki}\)</span> is the set of elements of <span class="math inline">\(A\)</span> included in the <span class="math inline">\(i\)</span>th ordered combination of <span class="math inline">\(k\)</span> elements; <span class="math inline">\(B_{ki}\)</span> is the set of ordered combinations of <span class="math inline">\(k\)</span> elements where the last element in the combination is not included in the <span class="math inline">\(i\)</span>th ordered combination of <span class="math inline">\(k - 1\)</span> elements. The indexing of ordered combinations is arbitrary.</p>
<p>Now, since <span class="math inline">\(b_{kij} \neq b_{kij'}\)</span> for <span class="math inline">\(j \neq j'\)</span>, <span class="math inline">\(|\tilde{b}_{ki}| = k\)</span>. Note also that <span class="math inline">\(|B_{ki}| = |A| - |\tilde{b}_{k-1, i}| = n - (k - 1)\)</span>, <span class="math inline">\(\{B_{ki}\}\)</span> is a mutually disjoint collection, and that <span class="math inline">\(B_k = \bigcup_i B_{ki}\)</span>. Then:</p>
<p><span class="math display">\[
|B_k|
= \left| \bigcup_{i = 1}^{|B_{k - 1}|} B_{ki} \right|
= \sum_{i = 1}^{|B_{k - 1}|} |B_{ki}|
= \sum_{i = 1}^{|B_{k - 1}|} \left[ n - (k - 1)\right]
= |B_{k - 1}| \left[ n - (k - 1)\right]
\]</span></p>
<p>So by recursion: <span class="math display">\[
\begin{align*}
|B_k| &amp;= |B_{k - 1}| \left[ n - (k - 1)\right] \\
&amp;= |B_{k - 2}| \left[ n - (k - 2)\right] \left[ n - (k - 1)\right] \\
&amp;\;\;\vdots \\
&amp;= |B_1| \left[n - 1\right] \cdots \left[ n - (k - 2)\right] \left[ n - (k - 1)\right] \\
&amp;= n (n - 1) \cdots (n - (k - 1))
\end{align*}
\]</span></p>
</div>
</div>
<p><strong>Sampling without replacement 2 (SWOR2)</strong>. Let <span class="math inline">\(A\)</span> be a set with <span class="math inline">\(|A| = n\)</span>. The Number of <span style="color:blue">unordered</span> combinations of <span class="math inline">\(k\)</span> distinct elements drawn without replacement from <span class="math inline">\(A\)</span> is:</p>
<p><span class="math display">\[
\frac{n!}{k! (n - k)!} = \frac{n\cdot (n - 1)\cdot \cdots \cdot (n - k + 1)}{k \cdot (k - 1) \cdot \cdots \cdot 2 \cdot 1}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(B_k\)</span> be the set of all <em>ordered</em> combinations of <span class="math inline">\(k\)</span> distinct elements drawn without replacement from <span class="math inline">\(A\)</span> (as in the proof of SWOR1) and consider: <span class="math display">\[
C_k = \{ \{a_{j_1}, \dots, a_{j_k}\} \subseteq A: j_i \neq j_{i'} \text{ for } i \neq i'\}
\quad\text{(all subsets of size $k$)}
\]</span></p>
<p>The goal is to show that <span class="math inline">\(|C_k| = \frac{n!}{k! (n - k)!}\)</span>. For each set <span class="math inline">\(C_{kj} \in C_k\)</span>, denote the set of ordered combinations formed from elements of <span class="math inline">\(C_{kj}\)</span> by <span class="math inline">\(B_{kj} = \{(a_{j_1}, \dots, a_{j_k}): a_{j_i} \in C_k\}\)</span>. Note that by construction, <span class="math inline">\(\{B_{kj}\}\)</span> is a partition of <span class="math inline">\(B_k\)</span>. Further, <span class="math inline">\(|C_{kj} = k|\)</span>, so by SWOR1 we have that <span class="math inline">\(|B_{kj}| = \frac{k!}{(k - k)!} = k!\)</span>, and then:</p>
<p><span class="math display">\[
|B_k| = \left| \bigcup_{j = 1}^{|C_k|} B_{kj} \right| = \sum_{j = 1}^{|C_k|} |B_{kj}| = \sum_{j = 1}^{|C_k|} k! = |C_k| k!
\]</span></p>
<p>It follows that:</p>
<p><span class="math display">\[
|C_k| = \frac{|B_k|}{k!} = \frac{n!}{k! (n - k)!}
\]</span></p>
</div>
</div>
<p>The types of combinations resulting from sampling without replacement have special names: ordered combinations of distinct elements drawn without replacement are known as <span style="color:blue">permutations</span>; and unordered combinations are known as <span style="color:blue">combinations</span>. It is common to denote the corresponding counting rules with special notation:</p>
<ul>
<li>(permutations) <span class="math inline">\(P^n_k\)</span> or <span class="math inline">\(P_{n, k}\)</span> for <span class="math inline">\(\frac{n!}{(n - k)!}\)</span></li>
<li>(combinations) <span class="math inline">\(C^n_k\)</span> or <span class="math inline">\(C_{n, k}\)</span> for <span class="math inline">\(\frac{n!}{k! (n - k)!}\)</span></li>
</ul>
<p>These won’t be used in this class, but it’s useful to be aware of the notation, as many books use them. We will, however, adopt the notation <span class="math inline">\({n \choose k}\)</span> for unordered combinations of elements drawn with replacement; this is read “<span class="math inline">\(n\)</span> choose <span class="math inline">\(k\)</span>”, because the counting rule gives the number of ways to choose <span class="math inline">\(k\)</span> items from among <span class="math inline">\(n\)</span> possibilities.</p>
<p>There are a few combination identities that will come in handy later. Proofs amount to simple arithmetic, and are left as exercises.</p>
<ul>
<li><span class="math inline">\({n \choose k} = (k + 1){n \choose k + 1}\)</span></li>
<li><span class="math inline">\({n + m \choose m} = {n + m \choose n}\)</span></li>
</ul>
<p><strong>Sampling with replacement 2 (SWR2).</strong> Let <span class="math inline">\(A\)</span> be a set with <span class="math inline">\(|A| = n\)</span>. The number of <span style="color:blue">unordered</span> combinations of <span class="math inline">\(k\)</span> (possibly nondistinct) elements drawn with replacement from <span class="math inline">\(A\)</span> is <span class="math inline">\({n + k - 1 \choose k}\)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
</div>
<div class="callout-body-container callout-body">
<p>The goal is to find <span class="math inline">\(|D_k|\)</span> where <span class="math inline">\(D_k = \{D_{kj} = [a_{j_1}, \dots, a_{j_k}]: j_i \in \{1, \dots, n\}\}\)</span>. Define:</p>
<p><span class="math display">\[
x_{ij} = \# \text{ of times } a_i \text{ is included in } D_{kj}
\]</span></p>
<p>Then <span class="math inline">\(\sum_{i = 1}^n x_{ij} = |D_{kj}| = k\)</span> by construction. Denote by <span class="math inline">\(x_j\)</span> the vector <span class="math inline">\((x_{1j}, x_{2j}, \dots, x_{nj)\)</span>. Note that <span class="math inline">\(D_{kj} = D_{kj'}\)</span> just in case <span class="math inline">\(x_j = x_{j'}\)</span>, and in fact there is a one-to-one correspondence between the elements of <span class="math inline">\(D_k\)</span> and the set <span class="math inline">\(V = \{x \in \{0, 1, \dots, k\}^n: \sum_{i = 1}^n x_i = k \}\)</span>. Thus, <span class="math inline">\(|D_k| = |V|\)</span>.</p>
<p>Consider the encoding of <span class="math inline">\(\sum_i x_{ij}\)</span> for an arbitrary <span class="math inline">\(x_j \in V\)</span> that results from expanding the sum and replacing integers by the corresponding number of vertical bars, for instance:</p>
<p><span class="math display">\[
\begin{align*}
\sum_{i = 1}^n x_{ij}
&amp;= 1 + 2 + 0 + 0 + 0 + 0 + 1 + \dots + 3 + 0 + 1 + 0 + 0 \\
&amp;= | + || + + + + | + \cdots + ||| + + | + +
\end{align*}
\]</span> Now, each unique <span class="math inline">\(x_j\)</span> will correspond to a distinct encoding sequence of <span class="math inline">\(|\)</span> and <span class="math inline">\(+\)</span>, and conversely each unique encoding sequence corresponds to exactly one <span class="math inline">\(x_j\)</span>. Further, there are precisely <span class="math inline">\(k\)</span> bars and <span class="math inline">\(n - 1\)</span> plus signs, so each encoding string comprises <span class="math inline">\(k + n - 1\)</span> characters. The unique encoding sequences result from the distinct allocations of bars to positions in the encoding string. In other words, there are exactly as many encoding sequences as there are ways to place the <span class="math inline">\(k\)</span> bars among the <span class="math inline">\(k + n - 1\)</span> positions. Thus:</p>
<p><span class="math display">\[
|D_k| = |V| = \text{\# of ways to allocate $k$ bars to $n + k - 1$ positions} = {n + k - 1 \choose k}
\]</span></p>
</div>
</div>
<p>The table below summarizes the four counting rules.</p>
<table class="table">
<caption>Counting rules.</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 36%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Drawn with replacement</th>
<th>Drawn without replacement</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Unordered</strong></td>
<td><span class="math display">\[                     
                 {n + k - 1 \choose k}   
                 \]</span></td>
<td><span class="math display">\[                        
                                          {n \choose k}              
                                          \]</span></td>
</tr>
<tr class="even">
<td><strong>Ordered</strong></td>
<td><span class="math display">\[                     
                 n^k                     
                 \]</span></td>
<td><span class="math display">\[                        
                                          \frac{n!}{(n - k)!}        
                                          \]</span></td>
</tr>
</tbody>
</table>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The notation <span class="math inline">\([x_1, \dots, x_n]\)</span> is an ad-hoc expression for the unordered collection consisting of <span class="math inline">\(x_1, \dots, x_n\)</span> possibly non-distinct elements. Some special notation is needed here because when the collection includes duplicates, it cannot be written as a set. For instance, <span class="math inline">\(\{0, 0, 1\} = \{0, 1\}\)</span> but <span class="math inline">\([0, 0, 1] \neq [0, 1]\)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">© 2023 Trevor Ruiz</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>